<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∏–Ω–æ-–ª–æ—Ç–µ—Ä–µ—è: –û–ø—Ä–æ—Å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="poll-body">
    <div class="background-rotator"></div>
    
    <div class="container poll-container">
        <header>
            <h1>–û–ø—Ä–æ—Å: –ö–∞–∫–æ–π —Ñ–∏–ª—å–º –ø–æ—Å–º–æ—Ç—Ä–∏–º?</h1>
            <div class="poll-description-row">
                <p id="poll-description">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω —Ñ–∏–ª—å–º –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ</p>
            </div>
            <div id="poll-winner-banner" class="poll-winner-banner" aria-live="polite" hidden></div>
        </header>

        <section class="poll-points-panel" aria-live="polite">
            <div class="points-widget">
                <div class="points-balance-card" id="points-widget">
                    <div class="points-balance-header">
                        <div>
                            <p class="points-balance-label" id="points-balance-label">–í–∞—à–∏ –±–∞–ª–ª—ã</p>
                            <p class="points-balance-value" id="points-balance-value">‚Äî</p>
                        </div>
                        <span class="points-state-badge" id="points-state-badge">‚Äî</span>
                    </div>
                    <p class="points-balance-status" id="points-balance-status">–ë–∞–ª–ª—ã –µ—â—ë –Ω–µ –Ω–∞—á–∏—Å–ª–µ–Ω—ã</p>
                    <div class="points-progress" id="points-progress" hidden>
                        <div class="points-progress-track">
                            <span class="points-progress-bar" id="points-progress-bar"></span>
                        </div>
                        <p class="points-progress-label" id="points-progress-label">–ù–∞—á–∏—Å–ª—è–µ–º –±–∞–ª–ª—ã‚Ä¶</p>
                    </div>
                </div>
                <div class="custom-vote-container">
                    <button
                        id="custom-vote-btn"
                        class="custom-vote-btn"
                        type="button"
                        title="–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ —Å–≤–æ–π —Ñ–∏–ª—å–º"
                        data-custom-vote-cost="{{ custom_vote_cost }}"
                    >
                        –ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ —Å–≤–æ–π —Ñ–∏–ª—å–º
                    </button>
                    <p
                        id="custom-vote-insufficient"
                        class="custom-vote-warning"
                        data-custom-vote-cost="{{ custom_vote_cost }}"
                        hidden
                    >
                        –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è.
                    </p>
                </div>
            </div>
        </section>

        <div id="poll-grid" class="poll-grid">
            <!-- –°–µ—Ç–∫–∞ —Ñ–∏–ª—å–º–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
        </div>

        <div id="poll-message" class="poll-message" style="display: none;">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>

        <section id="voted-movie-wrapper" class="poll-voted" style="display: none;" aria-live="polite">
            <h2>–í–∞—à –≤—ã–±–æ—Ä</h2>
            <div id="voted-movie-card" class="poll-voted-card">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞ -->
            </div>
        </section>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
    <div id="vote-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content vote-confirm-content">
            <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞</h2>
            <div class="vote-confirm-movie">
                <img id="vote-confirm-poster" src="" alt="–ü–æ—Å—Ç–µ—Ä">
                <div class="vote-confirm-info">
                    <h3 id="vote-confirm-title"></h3>
                    <p id="vote-confirm-year"></p>
                    <p id="vote-confirm-points" class="vote-confirm-points"></p>
                </div>
            </div>
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ —ç—Ç–æ—Ç —Ñ–∏–ª—å–º?</p>
            <div class="modal-buttons">
                <button id="vote-confirm-btn" class="cta-button">–î–∞, –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                <button id="vote-cancel-btn" class="secondary-button">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–∞–Ω–∞ —Ñ–∏–ª—å–º–∞ -->
    <div id="ban-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content ban-modal-content">
            <h2>–ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–ø—Ä–æ—Å–∞</h2>
            <div class="ban-modal-body">
                <p id="ban-modal-description" class="ban-modal-description"></p>
                <label class="ban-modal-label" for="ban-days-input">
                    –ù–∞ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∏—Å–∫–ª—é—á–∏—Ç—å? <span class="ban-label-formula">(1 –¥–µ–Ω—å = 1 –±–∞–ª–ª)</span>
                </label>
                <div class="ban-input-row">
                    <div class="ban-stepper">
                        <button type="button" class="ban-step-btn" data-ban-step="-1" aria-label="–£–º–µ–Ω—å—à–∏—Ç—å –Ω–∞ 1 –¥–µ–Ω—å">‚àí</button>
                        <input id="ban-days-input" class="ban-days-input" type="number" min="1" step="1" value="1">
                        <button type="button" class="ban-step-btn" data-ban-step="1" aria-label="–£–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞ 1 –¥–µ–Ω—å">+</button>
                    </div>
                    <span class="ban-cost-hint">–ë–∞–ª–ª—ã –±—É–¥—É—Ç —Å–ø–∏—Å–∞–Ω—ã —Å –≤–∞—à–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞</span>
                </div>
                <div class="ban-presets" aria-label="–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏">
                    <button type="button" class="ban-preset-btn" data-ban-preset="1">1 –¥–µ–Ω—å</button>
                    <button type="button" class="ban-preset-btn" data-ban-preset="3">3 –¥–Ω—è</button>
                    <button type="button" class="ban-preset-btn" data-ban-preset="7">7 –¥–Ω–µ–π</button>
                    <button type="button" class="ban-preset-btn" data-ban-preset="10">10 –¥–Ω–µ–π</button>
                </div>
                <p id="ban-modal-error" class="ban-modal-error" hidden></p>
            </div>
            <div class="modal-buttons">
                <button id="ban-confirm-btn" class="cta-button" type="button">–ò—Å–∫–ª—é—á–∏—Ç—å</button>
                <button id="ban-cancel-btn" class="secondary-button" type="button">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
    <div id="custom-vote-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content custom-vote-content">
            <h2>–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ —Å–≤–æ–π —Ñ–∏–ª—å–º</h2>
            <p
                id="custom-vote-cost-description"
                class="custom-vote-description"
                data-custom-vote-cost="{{ custom_vote_cost }}"
            >
                –ë—É–¥–µ—Ç —Å–ø–∏—Å–∞–Ω–æ {{ custom_vote_cost }} –±–∞–ª–ª–æ–≤ –∑–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ.
            </p>
            <label class="custom-vote-label" for="custom-vote-input">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ –∏–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫</label>
            <div class="custom-vote-input-row">
                <input id="custom-vote-input" class="custom-vote-input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞">
                <button id="custom-vote-search-btn" class="cta-button custom-vote-search-btn" type="button">–ù–∞–π—Ç–∏</button>
            </div>
            <div id="custom-vote-status" class="custom-vote-status" aria-live="polite" hidden>
                <div class="custom-vote-status-loading" id="custom-vote-status-loading" hidden>
                    <span class="custom-vote-spinner" aria-hidden="true"></span>
                    <p>–ò—â–µ–º —Ñ–∏–ª—å–º‚Ä¶</p>
                </div>
                <div class="custom-vote-status-empty" id="custom-vote-status-empty" hidden>
                    <span class="custom-vote-icon">üîç</span>
                    <p>–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ù–∞–π—Ç–∏¬ª.</p>
                </div>
                <div class="custom-vote-status-error" id="custom-vote-status-error" hidden>
                    <span class="custom-vote-icon">‚ö†Ô∏è</span>
                    <p id="custom-vote-error-text">–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ñ–∏–ª—å–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å.</p>
                </div>
            </div>
            <div id="custom-vote-result" class="custom-vote-result" hidden>
                <div class="custom-vote-result-card">
                    <div class="custom-vote-poster" id="custom-vote-poster"></div>
                    <div class="custom-vote-info">
                        <h3 id="custom-vote-title"></h3>
                        <p id="custom-vote-year" class="custom-vote-meta"></p>
                        <p id="custom-vote-rating" class="custom-vote-rating"></p>
                        <p id="custom-vote-description" class="custom-vote-description-text"></p>
                    </div>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="custom-vote-submit" class="cta-button" type="button">–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                <button id="custom-vote-cancel" class="secondary-button" type="button">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        const pollId = {{ poll.id|tojson }};
    </script>
    <div id="poll-config" data-custom-vote-cost="{{ custom_vote_cost }}" hidden></div>
    <script>
        window.appConfig = window.appConfig || {};
        window.appConfig.pollApiBaseUrl = {{ poll_api_base_url|tojson }};
    </script>
    <script src="{{ url_for('static', filename='js/toast.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/pages/poll.js') }}"></script>
    
    <script>
        var backgroundPhotos = {{ background_photos|tojson|safe }};
    </script>
    <script type="module" src="{{ url_for('static', filename='js/background.js') }}"></script>
</body>
</html>

